# Система контроля и управления доступом
## Общее описание
Данная система использует модульное строение. При выходе отдельных модулей можно легко их поменять. 

Общая схема подключения:
![общая схема подключения](images/assamble.png)
Подключение осуществляется с помощью витых пар прямого обжима. 

подключать можно электромагнитные замки 12-24, используется блок питания с штекером зарядного устройства 5,5x2,5 мм. 
Параметры блока питания: сила тока БП > сила тока замка + 100мА

В конструкции платы управления предусмотрен вход для пожарной сигнализации на 5в для аварийного открытия дверей.

В [папке](3D_models) можно найти 3d модели для корпусов.

В [папке](Gerber) можно найти Gerber файлы для производства печатных плат.
Все необходимые компоненты можно найти в [таблице](parts.xlsx).

## Сервер
Вычисление права доступа происходит на [сервере](Locks_server), на который отправляется серийный номер карточки, подключение к серверу осуществляется через TCP соединение. Для подключения считывателя необходимо создать [файл конфигурации](Locks_server/config). правила оформления файла конфигурации(все с новой строки, коментарий после символа '/'):

> a 69a073a0 /серийный номер карточки админов (максимум 10)

> b 10000 / время открытой двери

> c 14400000 / время для админа при зажатии кнопки

В файле [сервера](Locks_server/TCP_server.py) необходимо написать функцию check_booking для проверки доступа.

Сервер запускается как отдельное приложение, доступ к которому можно осуществлять при помощи модуля [master_code](Locks_server/master_code.py). Реализованные методы:
- открытие (open(mac)) замка от команды с сервера
- сканирование карточки(scan_EAC), возвращает серийный номер отсканированной карточки.

При подключении замка к серверу сервер отсылает на замок файл конфигурации.
На замке реализованно обновление конфигурации при приеме сообщения update.


Возможна настройка для работы без сервера, через мастер карточку([файл arduino_noEth.ino](arduino_noEth/arduino_noEth.ino)), Перед загрузкой необходимо вписать серийный номер мастер карточки.
